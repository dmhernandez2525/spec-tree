# F12.4 - Self-Hosted Option

## Overview

Self-hosted deployment configuration with environment validation, Docker Compose generation, nginx reverse proxy config, and database migration planning.

## Architecture

```
Client/lib/deployment/
  self-hosted.ts        # Deployment config, Docker, nginx, migrations
  deployment.test.ts    # 85 tests
```

## Features

| Function | Purpose |
|----------|---------|
| createDeploymentConfig | Merge overrides with sensible defaults |
| validateConfig | Domain, port, database, SSL validation |
| validateDomain | Localhost, IPv4, domain name validation |
| validateEnvironment | Memory, disk, CPU, port checks |
| generateDockerCompose | App + database + optional storage services |
| generateEnvFile | Environment variable file generation |
| createMigrationStep | Migration with up/down SQL |
| getMigrationPlan | Unapplied migration discovery |
| generateNginxConfig | Reverse proxy with optional SSL/TLS |
| estimateResources | Per-user resource scaling estimates |
| getDeploymentSummary | Human-readable config summary |

## Supported Databases

postgresql (5432), mysql (3306), sqlite

## Supported Storage

s3, local, gcs, azure-blob

## System Requirements

| Resource | Minimum |
|----------|---------|
| Memory | 2048 MB |
| Disk | 10 GB |
| CPU Cores | 2 |
| Ports | 3000, 5432 |

## Resource Scaling

Base 512MB + 10MB/user memory, base 5GB + 0.1GB/user disk, base 1 + 1 per 500 users CPU cores.

## Test Coverage

85 tests: DEFAULT_DB_PORTS (3), SYSTEM_REQUIREMENTS (4), DEFAULT_SELF_HOSTED_CONFIG (8), createDeploymentConfig (5), validateConfig (8), validateDomain (9), validateEnvironment (6), generateDockerCompose (8), generateEnvFile (7), createMigrationStep (4), getMigrationPlan (4), generateNginxConfig (6), estimateResources (5), getDeploymentSummary (8).
